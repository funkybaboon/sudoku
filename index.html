<!DOCTYPE HTML>
<html>
<head>
    <script>
        var urlParams;

        function createEmptySudoku() {
            var sudoku = [];
            for (var x = 1; x <= 9; x++) {
                sudoku[x] = [];
                for (var y = 1; y <= 9; y++) {
                    sudoku[x][y] = [];
                }
            }
            return sudoku;
        }

        var sudoku = createEmptySudoku();
        sudoku[1][1]['value'] = 1;
        sudoku[9][1]['value'] = 3;
        sudoku[5][2]['value'] = 6;
        sudoku[3][3]['value'] = 3;
        sudoku[6][3]['value'] = 1;

        sudoku[2][4]['value'] = 7;
        sudoku[4][4]['value'] = 1;
        sudoku[3][5]['value'] = 8;
        sudoku[7][5]['value'] = 5;
        sudoku[6][6]['value'] = 3;
        sudoku[8][6]['value'] = 4;

        sudoku[4][7]['value'] = 8;
        sudoku[7][7]['value'] = 6;
        sudoku[5][8]['value'] = 1;
        sudoku[1][9]['value'] = 6;
        sudoku[9][9]['value'] = 7;


        var background = '#C0FFC0';

        sudoku[3][1]['background'] = background;
        sudoku[5][1]['background'] = background;
        sudoku[6][1]['background'] = background;
        sudoku[8][1]['background'] = background;

        sudoku[3][2]['background'] = background;
        sudoku[5][2]['background'] = background;
        sudoku[6][2]['background'] = background;
        sudoku[9][2]['background'] = background;

        sudoku[1][3]['background'] = background;
        sudoku[2][3]['background'] = background;
        sudoku[8][3]['background'] = background;
        sudoku[9][3]['background'] = background;

        sudoku[1][4]['background'] = background;
        sudoku[6][4]['background'] = background;
        sudoku[7][4]['background'] = background;
        sudoku[9][4]['background'] = background;

        sudoku[2][5]['background'] = background;
        sudoku[3][5]['background'] = background;
        sudoku[4][5]['background'] = background;
        sudoku[5][5]['background'] = background;

        sudoku[2][6]['background'] = background;
        sudoku[5][6]['background'] = background;
        sudoku[7][6]['background'] = background;
        sudoku[8][6]['background'] = background;

        sudoku[1][7]['background'] = background;
        sudoku[4][7]['background'] = background;
        sudoku[7][7]['background'] = background;
        sudoku[9][7]['background'] = background;

        sudoku[4][8]['background'] = background;
        sudoku[6][8]['background'] = background;
        sudoku[7][8]['background'] = background;
        sudoku[8][8]['background'] = background;

        sudoku[1][9]['background'] = background;
        sudoku[2][9]['background'] = background;
        sudoku[3][9]['background'] = background;
        sudoku[4][9]['background'] = background;


        window.onpopstate = function () {
            var match;
            var pl = /\+/g;  // Regex for replacing addition symbol with a space
            var search = /([^&=]+)=?([^&]*)/g;
            var decode = function (s) {
                return decodeURIComponent(s.replace(pl, " "));
            };
            var query = window.location.search.substring(1);

            urlParams = {};
            while ((match = search.exec(query)) !== null)
                urlParams[decode(match[1])] = decode(match[2]);
        }();

        function seeGetParameters() {
            alert(JSON.stringify(urlParams, null, 4));
        }

        function changeDivValues() {
            document.getElementById("x1y1").innerHTML = "XXXXX";
        }

        window.onload = function(){
            tableCreate();

            var dialog = document.getElementById('window');
            document.getElementById('show').onclick = function() {
                dialog.show();
            };
            document.getElementById('exit').onclick = function() {
                dialog.close();
            };


            // make inner cells clickable
            for (var x = 0; x <= 6; x+=3) {
                for (var y = 0; y <= 6; y+=3) {
                    createInnnerCells(x,y);
                }
            }

            function createInnnerCells(xx, yy) {
                for (var x = 1; x <= 3; x++) {
                    for (var y = 1; y <= 3; y++) {
                        var X = y+yy;
                        var Y = x+xx;
                        var id = 'x' + [X] + 'y' + [Y];
                        document.getElementById(id).onclick = function() {
                            dialog.show();
                        };
                    }
                }
            }

            // close popover on click
            for (var i = 1; i <= 9; i++) {
                var id = 'z' + i;
                document.getElementById(id).onclick = function() {
                    dialog.close();
                };
            }


        };

        function tableCreate() {
            var body = document.getElementsByClassName("frame")[0];
            var containerDiv = body.appendChild(document.createElement('div'))
            containerDiv.className = 'container';

            function createInnnerCells(parent, xx, yy) {
                for (var x = 1; x <= 3; x++) {
                    for (var y = 1; y <= 3; y++) {
                        var div = parent.appendChild(document.createElement('div'))
                        var X = y+yy;
                        var Y = x+xx;

                        //var cellValue = "("+X+"|"+Y+")";

                        var cellValue = sudoku[X][Y]['value'] || '';

                        //createInnerButtons(div, cellValue);

                        div.style.background = sudoku[X][Y]['background'] || 'white'
                        div.className = 'cell';
                        div.id = 'x' + [X] + 'y' + [Y];
                        /*
                        div.onclick = function() {
                            dialog.show();
                        };
                        */
                        div.appendChild(document.createTextNode(cellValue));
                    }
                }
            }

            for (var x = 0; x <= 6; x+=3) {
                for (var y = 0; y <= 6; y+=3) {
                    var div = containerDiv.appendChild(document.createElement('div'))
                    div.className = 'block';
                    createInnnerCells(div, x, y);
                    /*
                     var cellValue = sudoku[x][y] || "";
                     div.appendChild(document.createTextNode(cellValue));*/
                }
            }
        }

    </script>
    <style>
        .frame {
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-items: flex-start;
        }
        .buttons {

        }
        .container {
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            align-content: space-around;

            height: 91vmin;
            width: 91vmin;
            background: black;
        }
        .block {
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            align-content: space-around;

            height: 30vmin;
            width: 30vmin;
            background: lightgrey;
        }
        .cell {
            color: red;
            text-align: center;
            vertical-align: middle;
            line-height: 10vmin;
            font-size: 5vmin;

            height: 9.5vmin;
            width: 9.5vmin;
            border: 1px solid black;
            background: white;
        }
        dialog {/*
            height: 40vmin;
            width: 40vmin;*/
            background:#e8e8e8;
            border: 1px solid #dadada;
            font-family:sans-serif;

            position: absolute;
            left: 0px;
            top: 0px;
            z-index: 999;

            padding: 0;
            border: 0;
        }
        .dialogblock {
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: space-around;
            align-items: center;
            align-content: space-around;

            height: 22vmin;
            width: 22vmin;
            background: lightgrey;
        }
        .dialogcell {
            color: black;
            text-align: center;
            vertical-align: middle;
            line-height: 7vmin;
            font-size: 4vmin;

            height: 7vmin;
            width: 7vmin;
            border: 1px solid black;
            background: white;
        }
    </style>
</head>
<body>
    <div class="frame">
        <div class="buttons">
            <p>
                <button onclick="seeGetParameters()">See Get Parameters</button>
            </p>
            <p>
                <button onclick="tableCreate()">Create Table</button>
            </p>
            <p>
                <button id="show">Show Dialog</button>
                <button id="exit">Close Dialog</button>
            </p>
        </div>
    </div>
    <dialog id="window">
        <div class="dialogblock">
            <div class="dialogcell" id="z1" style="background: white;">1</div>
            <div class="dialogcell" id="z2" style="background: white;">2</div>
            <div class="dialogcell" id="z3" style="background: white;">3</div>
            <div class="dialogcell" id="z4" style="background: white;">4</div>
            <div class="dialogcell" id="z5" style="background: white;">5</div>
            <div class="dialogcell" id="z6" style="background: white;">6</div>
            <div class="dialogcell" id="z7" style="background: white;">7</div>
            <div class="dialogcell" id="z8" style="background: white;">8</div>
            <div class="dialogcell" id="z9" style="background: white;">9</div>
        </div>
    </dialog>
</body>
</html>